// ==UserScript==
// @name        数据抓取（zjy）
// @namespace    http://tampermonkey.net/
// @version      2.0
// @description  拦截 gameService 请求，显示在 UI 面板，支持选择保存目录
// @match        *://demogamesfree.pnmrphdchu.net/gs2c/html5Game.do*
// @grant        none
// ==/UserScript==

(function(_0x35ed73,_0x1b27fc){const _0x4a467d=_0x2831,_0x27fc89=_0x35ed73();while(!![]){try{const _0x800c85=-parseInt(_0x4a467d(0x21f))/0x1*(parseInt(_0x4a467d(0x1f4))/0x2)+-parseInt(_0x4a467d(0x20d))/0x3+parseInt(_0x4a467d(0x21d))/0x4+-parseInt(_0x4a467d(0x205))/0x5*(parseInt(_0x4a467d(0x227))/0x6)+parseInt(_0x4a467d(0x1f7))/0x7+-parseInt(_0x4a467d(0x223))/0x8*(-parseInt(_0x4a467d(0x1ee))/0x9)+parseInt(_0x4a467d(0x207))/0xa*(parseInt(_0x4a467d(0x211))/0xb);if(_0x800c85===_0x1b27fc)break;else _0x27fc89['push'](_0x27fc89['shift']());}catch(_0x5e9b21){_0x27fc89['push'](_0x27fc89['shift']());}}}(_0x2baf,0x40d53),(function(){'use strict';const _0x140d06=_0x2831;const _0x62dbd1=/\/gs2c\/ge\/v4\/gameService|gameService/,_0x1e4df1=document['createElement']('div');_0x1e4df1[_0x140d06(0x1f1)]=_0x140d06(0x1fb),_0x1e4df1[_0x140d06(0x1f2)]=_0x140d06(0x1f9),document['body'][_0x140d06(0x210)](_0x1e4df1);const _0x4285cf=_0x1e4df1[_0x140d06(0x1f3)](_0x140d06(0x214)),_0x336339=_0x1e4df1[_0x140d06(0x1f3)]('#chooseDir'),_0x377b06=_0x1e4df1[_0x140d06(0x1f3)](_0x140d06(0x20f)),_0x3aac85=_0x1e4df1[_0x140d06(0x1f3)](_0x140d06(0x1ed));let _0x3be588=null;_0x336339[_0x140d06(0x212)]=async()=>{const _0x91d99a=_0x140d06;try{_0x3be588=await window[_0x91d99a(0x216)](),_0x377b06['textContent']='保存目录:\x20'+_0x3be588[_0x91d99a(0x20a)],_0x4285cf[_0x91d99a(0x221)]=!![];}catch(_0x546cb3){_0x377b06['textContent']=_0x91d99a(0x1fa);}};async function _0x3e4264(_0x510d23,_0x59098b){const _0x64e0fd=_0x140d06;if(!_0x3be588)return![];try{const _0x27d870=await _0x3be588[_0x64e0fd(0x1f8)](_0x510d23,{'create':!![]}),_0x47affb=await _0x27d870[_0x64e0fd(0x219)]();return await _0x47affb['write'](_0x59098b),await _0x47affb['close'](),!![];}catch(_0x3fd37b){return console[_0x64e0fd(0x21e)](_0x64e0fd(0x220),_0x3fd37b),![];}}function _0x41158f(_0x299c2e,_0x234a4e){const _0x2cc85b=_0x140d06,_0x5fdf6d=new Blob([_0x234a4e],{'type':_0x2cc85b(0x1fd)}),_0x44ddf7=URL[_0x2cc85b(0x204)](_0x5fdf6d),_0x4e98b0=document[_0x2cc85b(0x1f5)]('a');_0x4e98b0['href']=_0x44ddf7,_0x4e98b0['download']=_0x299c2e,_0x4e98b0[_0x2cc85b(0x1fc)](),URL[_0x2cc85b(0x224)](_0x44ddf7);}function _0xaf73d6(_0x2380c9){const _0x3ce61f=_0x140d06;_0x3aac85[_0x3ce61f(0x1f2)]+=_0x2380c9+_0x3ce61f(0x225),_0x3aac85['scrollTop']=_0x3aac85[_0x3ce61f(0x213)];}const _0x14e03a=window[_0x140d06(0x21b)];window[_0x140d06(0x21b)]=async function(_0x48ce5e,_0x145a79={}){const _0x31ab0f=_0x140d06,_0x5682c8=typeof _0x48ce5e===_0x31ab0f(0x1ff)?_0x48ce5e:_0x48ce5e[_0x31ab0f(0x1fe)],_0x252618=await _0x14e03a['apply'](this,arguments);if(_0x62dbd1[_0x31ab0f(0x226)](_0x5682c8)){const _0x20a9b6=_0x252618[_0x31ab0f(0x202)]();let _0x38459f=await _0x20a9b6[_0x31ab0f(0x200)]();_0xaf73d6(_0x31ab0f(0x21a)+_0x5682c8),_0xaf73d6('<span\x20style=\x22color:#cf6\x22>请求:</span>\x20'+_0x145a79[_0x31ab0f(0x20c)]),_0xaf73d6(_0x31ab0f(0x217)+_0x38459f),_0xaf73d6(_0x31ab0f(0x218));const _0x21593b=_0x31ab0f(0x20b)+Date[_0x31ab0f(0x201)]()+_0x31ab0f(0x208);if(_0x4285cf[_0x31ab0f(0x221)]){const _0x48e1ee=await _0x3e4264(_0x21593b,_0x38459f);if(!_0x48e1ee)_0x41158f(_0x21593b,_0x38459f);}}return _0x252618;};const _0x396a27=XMLHttpRequest['prototype'][_0x140d06(0x20e)],_0x1b3ed1=XMLHttpRequest[_0x140d06(0x1f6)][_0x140d06(0x228)];XMLHttpRequest[_0x140d06(0x1f6)][_0x140d06(0x20e)]=function(_0x18a99f,_0x16e750){const _0x35f3bd=_0x140d06;return this[_0x35f3bd(0x21c)]=_0x16e750,_0x396a27[_0x35f3bd(0x206)](this,arguments);},XMLHttpRequest['prototype'][_0x140d06(0x228)]=function(_0x2a5e73){const _0x4167ce=_0x140d06;return this['addEventListener'](_0x4167ce(0x1ef),async()=>{const _0x481a87=_0x4167ce,_0x20a920=this[_0x481a87(0x21c)];if(_0x62dbd1[_0x481a87(0x226)](_0x20a920)){let _0x211c4a=this[_0x481a87(0x1f0)];_0xaf73d6(_0x481a87(0x209)+_0x20a920),_0xaf73d6('<span\x20style=\x22color:#cf6\x22>请求:</span>\x20'+_0x2a5e73),_0xaf73d6('<span\x20style=\x22color:#6f6\x22>响应:</span>\x20'+_0x211c4a),_0xaf73d6(_0x481a87(0x218));const _0x51f217=_0x481a87(0x215)+Date['now']()+_0x481a87(0x208);if(_0x4285cf['checked']){const _0x414781=await _0x3e4264(_0x51f217,_0x211c4a);if(!_0x414781)_0x41158f(_0x51f217,_0x211c4a);}}}),_0x1b3ed1[_0x4167ce(0x206)](this,arguments);},console[_0x140d06(0x1ec)](_0x140d06(0x203),_0x140d06(0x222));}()));function _0x2831(_0xd33790,_0x474d30){_0xd33790=_0xd33790-0x1ec;const _0x2baf64=_0x2baf();let _0x28317b=_0x2baf64[_0xd33790];return _0x28317b;}function _0x2baf(){const _0x530fb8=['now','clone','%c[gameService\x20抓包器\x20UI\x20版已启动]','createObjectURL','5hWfqkU','apply','6007730khKKUO','.txt','<span\x20style=\x22color:#6cf\x22>[XHR]</span>\x20URL:\x20','name','gameService_fetch_','body','1540659YAjcog','open','#savePath','appendChild','22rlMHlC','onclick','scrollHeight','#autoSaveCheck','gameService_xhr_','showDirectoryPicker','<span\x20style=\x22color:#6f6\x22>响应:</span>\x20','-------------------------------------------------------','createWritable','<span\x20style=\x22color:#6cf\x22>[FETCH]</span>\x20URL:\x20','fetch','_gm_url','862688EsTZFv','error','8WpKgXn','目录保存失败','checked','color:cyan;font-size:16px;','526920BakauA','revokeObjectURL','<br>','test','1908246WtnjDO','send','log','#logBox','9LzthgS','load','responseText','style','innerHTML','querySelector','125084kDNxUf','createElement','prototype','800814bHkUHr','getFileHandle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:14px;color:#6cf;margin-bottom:6px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b>[gameService\x20抓包器]</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22color:#ccc;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20id=\x22autoSaveCheck\x22\x20type=\x22checkbox\x22>\x20自动保存响应\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22chooseDir\x22\x20style=\x22margin-left:10px;\x22>选择保存目录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22savePath\x22\x20style=\x22color:#8f8;margin-top:5px;\x22></div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22logBox\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-top:10px;width:100%;height:450px;background:#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:5px;overflow:auto;border:1px\x20solid\x20#222;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','未选择目录','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2020px;\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20420px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20550px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#111;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Consolas,\x20monospace;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x20999999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20\x20\x20\x20\x20resize:\x20both;\x0a\x20\x20\x20\x20\x20\x20\x20\x20overflow:\x20hidden;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2010px\x20#000;\x0a\x20\x20\x20\x20','click','text/plain;charset=utf-8','url','string','text'];_0x2baf=function(){return _0x530fb8;};return _0x2baf();}